<!DOCTYPE html>
<html>
  <head>
    <title><%= content_for(:title) || t('layouts.application.mandala_life') %></title>
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <meta name="apple-mobile-web-app-capable" content="yes">
    <meta name="application-name" content="<%= t('layouts.application.mandala_life') %>">
    <meta name="mobile-web-app-capable" content="yes">
    <%= csrf_meta_tags %>
    <%= csp_meta_tag %>

    <%= yield :head %>

    <%# Enable PWA manifest for installable apps (make sure to enable in config/routes.rb too!) %>
    <%#= tag.link rel: "manifest", href: pwa_manifest_path(format: :json) %>

    <%= favicon_link_tag asset_path('logo.jpg'), type: 'image/jpeg' %>
    <%= favicon_link_tag asset_path('logo.jpg'), rel: 'apple-touch-icon', type: 'image/jpeg' %>

    <%# Includes all stylesheet files in app/assets/stylesheets %>
    <%= stylesheet_link_tag "tailwind", "data-turbo-track": "reload" %>
    <%= javascript_importmap_tags %>
  </head>

  <body class="bg-gray-50 min-h-screen">
    <nav class="bg-white shadow-sm fixed top-0 w-full z-10">
      <div class="mx-auto max-w-7xl px-4 sm:px-6 lg:px-8">
        <div class="flex h-16 justify-between">
          <div class="flex">
            <div class="flex flex-shrink-0 items-center">
              <%= link_to root_path, class: "flex items-center text-xl font-bold text-indigo-600" do %>
                <%= image_tag "logo.jpg", class: "h-8 w-8 rounded-md mr-2", alt: "Logo" %>
                <%= t('layouts.application.mandala_life') %>
              <% end %>
            </div>
            <div class="hidden sm:ml-6 sm:flex sm:space-x-8">
              <%= link_to t('layouts.application.annual_themes'), annual_themes_path, class: "inline-flex items-center border-b-2 px-1 pt-1 text-sm font-medium #{current_page?(annual_themes_path) ? 'border-indigo-500 text-gray-900' : 'border-transparent text-gray-500 hover:border-gray-300 hover:text-gray-700'}" %>
              <%= link_to t('layouts.application.daily_tasks'), daily_tasks_path, class: "inline-flex items-center border-b-2 px-1 pt-1 text-sm font-medium #{request.path.start_with?('/daily_tasks') ? 'border-indigo-500 text-gray-900' : 'border-transparent text-gray-500 hover:border-gray-300 hover:text-gray-700'}" %>
              <%= link_to t('layouts.application.reflections'), reflections_path, class: "inline-flex items-center border-b-2 px-1 pt-1 text-sm font-medium #{request.path.start_with?('/reflections') ? 'border-indigo-500 text-gray-900' : 'border-transparent text-gray-500 hover:border-gray-300 hover:text-gray-700'}" %>
            </div>
          </div>
          <div class="flex items-center">
            <div class="relative mr-4" data-controller="dropdown">
              <button type="button" data-action="dropdown#toggle" class="flex items-center space-x-1 text-sm font-medium text-gray-500 hover:text-gray-900 focus:outline-none">
                <span><%= I18n.locale.to_s.upcase %></span>
                <svg class="h-5 w-5 text-gray-400" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 20 20" fill="currentColor" aria-hidden="true">
                  <path fill-rule="evenodd" d="M5.23 7.21a.75.75 0 011.06.02L10 11.168l3.71-3.938a.75.75 0 111.08 1.04l-4.25 4.5a.75.75 0 01-1.08 0l-4.25-4.5a.75.75 0 01.02-1.06z" clip-rule="evenodd" />
                </svg>
              </button>
              
              <div data-dropdown-target="menu" class="hidden absolute right-0 z-10 mt-2 w-24 origin-top-right rounded-md bg-white shadow-lg ring-1 ring-black ring-opacity-5 focus:outline-none">
                <div class="py-1">
                  <% I18n.available_locales.each do |locale| %>
                    <%= link_to locale.to_s.upcase, { locale: locale }, class: "block px-4 py-2 text-sm text-gray-700 hover:bg-gray-100 #{I18n.locale == locale ? 'bg-gray-50 font-bold' : ''}" %>
                  <% end %>
                </div>
              </div>
            </div>
            <div class="flex items-center">
            <% if user_signed_in? %>
              <%= button_to t('common.sign_out'), destroy_user_session_path, method: :delete, class: "text-sm font-medium text-gray-500 hover:text-gray-700 bg-transparent border-0 cursor-pointer" %>
            <% else %>
              <%= link_to t('common.sign_in'), new_user_session_path, class: "text-sm font-medium text-gray-500 hover:text-gray-700" %>
            <% end %>
          </div>
        </div>
      </div>
    </nav>

    <main class="container mx-auto mt-20 px-4 sm:px-6 lg:px-8 py-8">
      <% if notice %>
        <div class="rounded-md bg-green-50 p-4 mb-6">
          <div class="flex">
            <div class="flex-shrink-0">
              <svg class="h-5 w-5 text-green-400" viewBox="0 0 20 20" fill="currentColor" aria-hidden="true">
                <path fill-rule="evenodd" d="M10 18a8 8 0 100-16 8 8 0 000 16zm3.857-9.809a.75.75 0 00-1.214-.882l-3.483 4.79-1.88-1.88a.75.75 0 10-1.06 1.061l2.5 2.5a.75.75 0 001.137-.089l4-5.5z" clip-rule="evenodd" />
              </svg>
            </div>
            <div class="ml-3">
              <p class="text-sm font-medium text-green-800"><%= notice %></p>
            </div>
          </div>
        </div>
      <% end %>
      <% if alert %>
        <div class="rounded-md bg-red-50 p-4 mb-6">
          <div class="flex">
            <div class="flex-shrink-0">
              <svg class="h-5 w-5 text-red-400" viewBox="0 0 20 20" fill="currentColor" aria-hidden="true">
                <path fill-rule="evenodd" d="M10 18a8 8 0 100-16 8 8 0 000 16zM8.28 7.22a.75.75 0 00-1.06 1.06L8.94 10l-1.72 1.72a.75.75 0 101.06 1.06L10 11.06l1.72 1.72a.75.75 0 101.06-1.06L11.06 10l1.72-1.72a.75.75 0 00-1.06-1.06L10 8.94 8.28 7.22z" clip-rule="evenodd" />
              </svg>
            </div>
            <div class="ml-3">
              <p class="text-sm font-medium text-red-800"><%= alert %></p>
            </div>
          </div>
        </div>
      <% end %>

      <%= yield %>
    </main>
  </body>
</html>
